---
sidebar: sidebar 
permalink: use/task-replicate-data.html 
keywords: amazon fsx for netapp ontap, fsx, manage fsx for ontap system, delete fsx for ontap system, remove fsx for ontap system, throughput capacity, change throughput, automatic capacity management, capacity management, storage capacity, replication, classification, sync, backup, recovery, bluexp, NetApp Console 
summary: Después de crear o descubrir un sistema FSx para ONTAP en la NetApp Console, puede administrar el sistema de archivos y usar los servicios de datos de NetApp que brindan capacidades como respaldo y recuperación. 
---
= Replica datos a FSx para ONTAP en NetApp Console
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Replica datos para protegerte contra la pérdida de datos si la región donde residen tus datos sufre un desastre. La replicación de datos es compatible entre FSx for ONTAP file systems y sistemas ONTAP locales o Cloud Volumes ONTAP.

Para la migración de VM de almacenamiento, debes completar la operación de transición justo después de crear una relación de replicación.



== Acerca de esta tarea

La replicación protege tus datos de desastres regionales y admite la migración de storage VM.

Los volúmenes replicados en el sistema de archivos de destino son volúmenes de protección de datos (DP) y siguen el formato de nomenclatura: `{OriginalVolumeName}_copy`.

Si replicas un volumen de origen con archivos inmutables, el volumen de destino y el sistema de archivos permanecen bloqueados hasta que termine el periodo de retención del volumen de origen. La función de archivos inmutables está disponible cuando link:https://docs.netapp.com/us-en/workload-fsx-ontap/create-volume.html["crear un volumen"] para un sistema de archivos FSx for ONTAP.

[NOTE]
====
* La replicación no es compatible con volúmenes de bloques que usan los protocolos iSCSI o NVMe.
* Puedes replicar un volumen de origen (lectura/escritura) o un volumen de protección de datos (DP). Se admite la replicación en cascada, pero no un tercer salto. Más información sobre link:https://review.docs.netapp.com/us-en/workload-fsx-ontap_cascade-replication/cascade-replication.html["replicación en cascada"^].


====


=== Casos de uso de migración

Cuando seleccionas el caso de uso de migración, puedes seleccionar opcionalmente replicar los datos de la VM de almacenamiento y la configuración para una sola VM de almacenamiento. Cuando migres datos y configuración al mismo tiempo, asegúrate de que la última replicación del volumen se haya completado en las últimas 24 horas. Todos los volúmenes en la misma VM de almacenamiento deben estar seleccionados para usar esta función. La política de organización en niveles para todos los volúmenes se establece por defecto en la política de organización en niveles del volumen de origen, lo cual se recomienda para los casos de migración.

Workload Factory admite la replicación de migración entre los siguientes sistemas de almacenamiento.

* Sistemas ONTAP locales y FSx para ONTAP file systems
* Cloud Volumes ONTAP y FSx para sistemas de archivos ONTAP
* FSx for ONTAP y sistemas de archivos FSx for ONTAP
+
** De primera a primera generación
** De primera a segunda generación
** De segunda a segunda generación




Para migrar los datos de la máquina virtual de almacenamiento y la configuración, tienes que completar dos operaciones.

. <<Crear una relación de replicación,Crear una relación de replicación>>, selecciona *Migración* como caso de uso y selecciona *Replicar la configuración de la máquina virtual de almacenamiento*.
. <<Cut over replication,transición de la replicación>> para migrar de forma permanente datos y ajustes de configuración del sistema de archivos de origen al sistema de archivos FSx for ONTAP de destino.


Para usar esta función, crea un



== Crear una relación de replicación

Replica datos entre dos sistemas de archivos FSx for ONTAP, entre un sistema ONTAP local y un sistema de archivos FSx for ONTAP, o entre Cloud Volumes ONTAP y un sistema de archivos FSx for ONTAP.

.Antes de empezar
Revisa estos requisitos antes de empezar.

* Para replicar datos entre FSx para ONTAP y ONTAP local o Cloud Volumes ONTAP, tienes que asociar un enlace a un sistema de archivos. link:https://docs.netapp.com/us-en/workload-fsx-ontap/create-link.html["Aprende cómo asociar un enlace existente o crear y asociar un nuevo enlace"]. Después de asociar el enlace, vuelve a esta operación.
* Para la replicación desde un sistema ONTAP local a un sistema de archivos FSx for ONTAP, asegúrate de haber detectado el sistema ONTAP local.
* La replicación no es compatible con volúmenes en un estado distinto de disponible, creado o mal configurado, y cuando la versión de ONTAP no es compatible.
* Para los casos de uso de migración, asegúrate de que la última replicación para el volumen se haya completado en las últimas 24 horas antes de crear una relación de replicación con los datos y la configuración de la máquina virtual de almacenamiento.


.Pasos
. Desde la página Systems de la consola NetApp, arrastra el sistema de archivos FSx for ONTAP de origen, el sistema ONTAP local o el sistema Cloud Volumes ONTAP sobre el sistema de archivos FSx for ONTAP de destino y selecciona *Replication*.
. En la página Crear replicación, seleccione los volúmenes de origen que desea replicar y luego haga clic en *Siguiente*.
. En Objetivo de replicación, proporcione lo siguiente:
+
.. *Nombre de destino*: aplicaste el nombre de destino cuando arrastraste y soltaste el sistema de almacenamiento de origen en el sistema de destino en la página Console Systems.
.. *Caso de uso*: Seleccione uno de los siguientes casos de uso para la replicación.  Dependiendo del caso de uso seleccionado, Workload Factory completa el formulario con valores recomendados de acuerdo con las mejores prácticas.  Puede aceptar los valores recomendados o realizar cambios a medida que completa el formulario.
+
*** Migración: transfiere sus datos al sistema de archivos FSx de destino para ONTAP
+
*Replicar configuración de VM de almacenamiento*: Opcionalmente, selecciona replicar los datos y los ajustes de configuración de la VM de almacenamiento para una sola VM de almacenamiento. Al migrar datos y ajustes de configuración al mismo tiempo, asegúrate de que la última replicación del volumen se haya completado en las últimas 24 horas. Todos los volúmenes en la misma VM de almacenamiento deben estar seleccionados para usar esta función. La política de niveles para todos los volúmenes se establece por defecto en la política de niveles del volumen de origen, lo cual se recomienda para casos de migración.

*** Recuperación ante desastres en caliente: garantiza una alta disponibilidad y una rápida recuperación ante desastres para cargas de trabajo críticas
*** Recuperación ante desastres en frío o archivo:
+
**** Recuperación ante desastres en frío: utiliza objetivos de tiempo de recuperación (RTO) y objetos de punto de recuperación (RPO) más largos para reducir costos
**** Archivo: replica datos para almacenamiento a largo plazo y cumplimiento normativo


*** Otro
+
Además, la selección del caso de uso determina la política de replicación, o política de SnapMirror (ONTAP).  Los términos utilizados para describir las políticas de replicación provienen delink:https://docs.netapp.com/us-en/ontap/data-protection/default-protection-policies-concept.html["Documentación de ONTAP 9"^] .

+
**** Para la migración y otros, la política de replicación se llama _MirrorAllSnapshots_.  _MirrorAllSnapshots_ es una política asincrónica para reflejar todas las instantáneas y el último sistema de archivos activo.
**** Para la recuperación ante desastres en caliente, en frío o de archivo, la política de replicación se denomina _MirrorAndVault_.  _MirrorAndVault_ es una política asincrónica y de bóveda para reflejar el último sistema de archivos activo y las instantáneas diarias y semanales.
+
Para todos los casos de uso, si habilita las instantáneas para la retención a largo plazo, la política de replicación predeterminada es _MirrorAndVault_.





.. *Sistema de archivos FSx para ONTAP*: selecciona las credenciales, la región y el nombre del sistema de archivos FSx para ONTAP para el sistema de archivos FSx para ONTAP de destino.
.. *Nombre de la máquina virtual de almacenamiento*: seleccione la máquina virtual de almacenamiento en el menú desplegable.  La máquina virtual de almacenamiento que seleccione es el destino de todos los volúmenes seleccionados en esta relación de replicación.
.. *Nombre del volumen*: El nombre del volumen de destino se genera automáticamente con el siguiente formato `{OriginalVolumeName}_copy` .  Puede utilizar el nombre de volumen generado automáticamente o ingresar otro nombre de volumen.
.. *Política de niveles*: seleccione la política de niveles para los datos almacenados en el volumen de destino.  La política de niveles tiene como valor predeterminado la política de niveles recomendada para el caso de uso que seleccionó.
+
_Equilibrado (automático)_ es la política de niveles predeterminada al crear un volumen mediante la consola de Workload Factory.  Para obtener más información sobre las políticas de niveles de volumen, consultelink:https://docs.aws.amazon.com/fsx/latest/ONTAPGuide/volume-storage-capacity.html#data-tiering-policy["Capacidad de almacenamiento de volumen"^] en la documentación de AWS FSx para NetApp ONTAP .  Tenga en cuenta que Workload Factory utiliza nombres basados ​​en casos de uso en la consola de Workload Factory para las políticas de niveles e incluye los nombres de políticas de niveles de FSx para ONTAP entre paréntesis.

+
Si seleccionó el caso de uso de migración, Workload Factory selecciona automáticamente copiar la política de niveles del volumen de origen al volumen de destino.  Puede anular la selección para copiar la política de niveles y seleccionar una política de niveles que se aplique al volumen seleccionado para la replicación.

.. *Tasa máxima de transferencia*: seleccione *Limitado* e ingrese el límite máximo de transferencia en MB/s.  Alternativamente, seleccione *Ilimitado*.
+
Sin un límite, el rendimiento de la red y de las aplicaciones puede disminuir.  Como alternativa, recomendamos una velocidad de transferencia ilimitada para los sistemas de archivos FSx para ONTAP para cargas de trabajo críticas, por ejemplo, aquellas que se utilizan principalmente para recuperación ante desastres.



. En Configuración de replicación, proporcione lo siguiente:
+
.. *Intervalo de replicación*: seleccione la frecuencia con la que se transfieren las instantáneas desde el volumen de origen al volumen de destino.
.. *Retención a largo plazo*: de manera opcional, habilite las instantáneas para la retención a largo plazo.  La retención a largo plazo permite que los servicios comerciales sigan funcionando incluso en caso de una falla total del sitio, lo que permite que las aplicaciones conmuten por error de forma transparente mediante una copia secundaria.
+
Las replicaciones sin retención a largo plazo utilizan la política _MirrorAllSnapshots_.  Al habilitar la retención a largo plazo se asigna la política _MirrorAndVault_ a la replicación.

+
Si habilita la retención a largo plazo, seleccione una política existente o cree una nueva para definir las instantáneas que se replicarán y la cantidad que se conservará.

+

NOTE: Para la retención a largo plazo se requieren etiquetas de origen y destino que coincidan.  Si lo desea, Workload Factory puede crear las etiquetas faltantes para usted.

+
*** *Elija una política existente*: seleccione una política existente del menú desplegable.
*** *Crear una nueva política*: ingrese un *nombre de política*.


.. *Instantáneas inmutables*: Opcional.  Seleccione *Habilitar instantáneas inmutables* para evitar que las instantáneas tomadas en esta política se eliminen durante el período de retención.
+
*** Establezca el *Período de retención* en número de horas, días, meses o años.
*** *Políticas de instantáneas*: en la tabla, seleccione la frecuencia de la política de instantáneas y la cantidad de copias que desea conservar.  Puede seleccionar más de una política de instantáneas.


.. *Punto de acceso S3*: opcionalmente, adjunta un punto de acceso S3 para acceder a los datos del sistema de archivos FSx for ONTAP que residen en volúmenes NFS o SMB/CIFS a través de las API de AWS S3. Solo se admite el tipo de acceso a archivos. Proporciona los siguientes detalles:
+
*** *Nombre del punto de acceso S3*: Ingresa el nombre del punto de acceso S3.
*** *Usuario*: selecciona un usuario existente con acceso al volumen o crea un nuevo usuario.
*** *Tipo de usuario*: selecciona *UNIX* o *Windows* como tipo de usuario.
*** *Configuración de red*: selecciona *Internet* o *Virtual private cloud (VPC)*. El tipo de red que elijas determina si el punto de acceso es accesible desde internet o está restringido a una VPC específica.
*** *Habilitar metadatos*: habilitar metadatos crea una tabla de S3 que contiene todos los objetos accesibles por el punto de acceso de S3, que puedes usar para auditoría, gobernanza, automática, análisis y optimización. Habilitar metadatos genera costes adicionales de AWS. Consulta link:https://aws.amazon.com/s3/pricing/["Documentación de precios de Amazon S3"^] para más información.


.. *Etiquetas de punto de acceso S3*: opcionalmente, puedes añadir hasta 50 etiquetas.




. Seleccione *Crear*.


.Resultado
La relación de replicación aparece en la pestaña *Replication relationships* del sistema de archivos FSx for ONTAP de destino.

Si creaste una relación de replicación con fines de migración, debes realizar la transición de todos los volúmenes y su VM de almacenamiento asociada para completar la migración de los datos de la VM de almacenamiento y los ajustes de configuración al sistema de archivos de destino FSx for ONTAP.



== Transición de replicación para casos de migración

Después de crear una relación de replicación para un caso de uso de migración, debes realizar la transición de la replicación para completar la migración de los datos y los ajustes de configuración de la máquina virtual de almacenamiento al sistema de archivos FSx for ONTAP de destino. La transición de la replicación migra permanentemente los datos y los ajustes de configuración de la máquina virtual de almacenamiento desde el sistema de archivos de origen al sistema de archivos FSx for ONTAP de destino. Durante la transición, los datos se replican por última vez. El sistema elimina los volúmenes de origen después de que se completa la transición. No puedes deshacer esta acción.

.Antes de empezar
Revisa estos requisitos antes de empezar.

* Detén cualquier acceso de clientes a tu VM de almacenamiento antes de la transición de la replicación.
* Asegúrate de que todos los volúmenes de origen no estén sirviendo ningún dato antes de la transición de la replicación.
* Asegúrate de que los datos estén sincronizados entre los volúmenes de origen y destino antes de realizar la transición de la replicación.
* El sistema de ficheros FSx for ONTAP que uses para la relación de replicación debe tener un enlace asociado. link:https://docs.netapp.com/us-en/workload-fsx-ontap/create-link.html["Aprende cómo asociar un enlace existente o crear y asociar un nuevo enlace"]. Después de asociar el enlace, vuelve a esta operación.


.Pasos
. En la consola NetApp, selecciona el menú image:workloads-menu-icon.png["El icono del menú hamburguesa se usa para navegar a cargas de trabajo como almacenamiento, eda, ai, bases de datos, vmware y administración."] y luego selecciona *Almacenamiento*.
. En el menú Storage, selecciona *FSx for ONTAP*.
. En *FSx for ONTAP*, selecciona el sistema de archivos que contiene el o los volúmenes que quieres replicar.
. Selecciona la pestaña *Relaciones de réplica*.
. En la tabla de relaciones de replicación, selecciona la relación de replicación para hacer la transición y luego selecciona *Transición de replicación*.
. Revisa la información en el cuadro de diálogo de transición de replicación y luego escribe _cut over_ para confirmar.


. Selecciona *transición*.


.Resultado
Después de la transición, los volúmenes de origen se eliminan y los volúmenes de destino pasan a ser de lectura/escritura. Puedes link:https://docs.netapp.com/us-en/workload-fsx-ontap/change-tiering-policy.html["modifica la política de niveles"] para los volúmenes de destino después de la transición.
